var initFrame;function init(){initFrame=document.getElementById("workframe").innerHTML}function reInit(){document.getElementById("workframe").innerHTML=initFrame}document.addEventListener("DOMContentLoaded",(function(event){console.log("DOM fully loaded and parsed"),init()}));const groupCommands=["dmove","hide","show","back","backward","front","forward","add","type"],attrOnly=["height","width","x","y"];function runCmd(){var inp=document.getElementById("jsinput").value.trim();inp=inp.replace(new RegExp(String.fromCharCode(92)+"n","g"),"");var arr=inp.split(";");console.log(arr.toString()),arr.forEach((function(item){if(item&&"//"!=item.slice(0,2)){if("drawing."==item.slice(0,9)&&(item=item.substr(9)),":"==item.charAt(0))return console.log("Current input = :"+item.substr(1).trim()),void eval(item.substr(1).trim());console.log("Current input = "+item);var showRes="?"==item.charAt(0);showRes&&(item=item.slice(1).trim());var regex=String.fromCharCode(92)+"(.*"+String.fromCharCode(92)+")",args=item.match(new RegExp(regex));if(args){args=args[0];var argsArr=args.slice(1,args.length-1).split(",");for(i=0;i<argsArr.length;i++){if(argsArr[i].indexOf("=")>=0)return void alert("Keine '=' Zeichen in Argumenten erlaubt.");argsArr[i]=unQuote(argsArr[i].trim())}console.log("Arguments = "+argsArr.toString()),item=item.replace(args,"")}else if(item.indexOf("=")>0){var last=item.indexOf("=")>0?item.indexOf("="):item.length,attrval=item.slice(last+1,item.length).trim();item=item.replace(attrval,"").trim(),item=item.replace("=","").trim()}var elem=item.slice(item.lastIndexOf(".")+1).trim(),obj=item.slice(0,item.lastIndexOf(".")).trim();switch(console.log("Output requested? = "+showRes),console.log("Object = "+obj),attrval?(console.log("Attribute = "+elem),console.log("Attribute value = "+attrval)):args?console.log("Method call = "+elem+args):console.log("Attribute = "+elem),elem){case"createRect":var params=args.substr(1,args.length-2).split(",");if(!params||0==params.length)return;console.log("params = "+params.toString()),params[0]=unQuote(params[0])+"_obj",isNaN(params[1])&&(params[1]=100),isNaN(params[2])&&(params[2]=100),isNaN(params[3])&&(params[3]=50),isNaN(params[4])&&(params[4]=50),params[5]||(params[5]="'white'"),evalCmd="SVG('drawing').rect("+params[3]+","+params[4]+").attr('id','"+params[0]+"').attr('stroke', 'black').attr('stroke-width', 5).attr('type', 'rect').fill("+params[5]+").move("+params[1]+","+params[2]+");",console.log("eval command = "+evalCmd);try{eval(evalCmd)}catch(err){alert("Syntaxfehler, siehe Anleitung!")}return;case"createCircle":var params=args.substr(1,args.length-2).split(",");if(!params||0==params.length)return;console.log("params = "+params.toString()),params[0]=unQuote(params[0]).trim()+"_obj",isNaN(params[1])&&(params[1]=100),isNaN(params[2])&&(params[2]=100),isNaN(params[3])&&(params[3]=20),params[4]||(params[4]="'white'"),evalCmd="SVG('drawing').circle("+params[3]+").attr('id','"+params[0]+"').attr('stroke', 'black').attr('stroke-width', 5).attr('type', 'circle').fill("+params[4]+").move("+params[1]+","+params[2]+");",console.log("eval command = "+evalCmd);try{eval(evalCmd)}catch(err){alert("Syntaxfehler, siehe Anleitung!")}return;case"createLine":var params=args.substr(1,args.length-2).split(",");if(!params||0==params.length)return;console.log("params = "+params.toString()),params[0]=unQuote(params[0]).trim()+"_obj",isNaN(params[1])&&(params[1]=10),isNaN(params[2])&&(params[2]=10),isNaN(params[3])&&(params[3]=50),isNaN(params[4])&&(params[4]=50),params[5]||(params[5]="'black'"),evalCmd="SVG('drawing').line("+params[1]+","+params[2]+","+params[3]+","+params[4]+").attr('id','"+params[0]+"').attr('type', 'line').attr('stroke',"+params[5]+").attr('stroke-width', 5)",console.log("eval command = "+evalCmd);try{eval(evalCmd)}catch(err){alert("Syntaxfehler, siehe Anleitung!")}return;case"createPolygon":var params=args.substr(1,args.length-2).match(new RegExp('".*?"',"g"));if(!params||0==params.length)return;params.forEach((function(param,idx,arr){arr[idx]=param.trim()})),console.log("params = "+params.toString()),params[0]=unQuote(params[0]).trim()+"_obj",params[1]||(params[1]="'10,10 90,10 50,50'"),params[2]||(params[2]="'white'"),evalCmd="SVG('drawing').polygon("+params[1]+").attr('id','"+params[0]+"').attr('stroke', 'black').attr('stroke-width', 5).attr('type', 'polygon').fill("+params[2]+");",console.log("eval command = "+evalCmd);try{eval(evalCmd)}catch(err){alert("Syntaxfehler, siehe Anleitung!")}return;case"createGroup":if(groupId=args.substr(1,args.length-2),!groupId)return void alert("Syntaxfehler, createGroup needs an id as argument.");evalCmd="SVG('drawing').group().attr('id',"+groupId+").attr('type', 'group')",console.log("eval command = "+evalCmd);try{eval(evalCmd)}catch(err){alert("Syntaxfehler, siehe Anleitung!")}return}switch(elem){case"move":elem="dmove";break;case"fillcolor":elem="fill";break;case"radius":elem="r";break;case"x":elem="circle"==objType?cx:elem;break;case"y":elem="circle"==objType?cy:elem}var svgObj=SVG.get(obj);if(!svgObj){if(svgObj=SVG.get(obj+"_obj"),!svgObj)return void alert("Objekt '"+obj+"' existiert nicht!");obj+="_obj"}var objType=svgObj.attr("type");if(console.log("Object = "+obj+"; Type = "+objType),"group"==objType&&groupCommands.indexOf(elem)<0&&(obj+="_obj"),attrval)var cmd=".attr('"+elem+"',"+attrval+")";else if("add"==elem&&"group"==objType){var obj2Add=unQuote(args.substr(1,args.length-2));obj2Add+=obj2Add.endsWith("_obj")?"":"_obj";var cmd=".add(SVG.get('"+obj2Add+"'))";cmd+=";SVG.get('"+obj2Add+"').attr('id','"+obj+"."+obj2Add+"')"}else if(args){if(!(attrOnly.indexOf(elem)<0))return void alert("Syntaxfehler beim Setzen des Attributs '"+elem+"'");var cmd="."+elem+args}else var cmd=".attr('"+elem+"')";console.log("Command = "+cmd);try{var dbgAttrCheck=SVG.get(obj).attr(),evalCmd="SVG.get('"+obj+"')"+cmd;showRes&&(evalCmd="document.getElementById('results').innerHTML="+evalCmd),console.log("eval command = "+evalCmd),eval(evalCmd)}catch(err){alert("Syntaxfehler oder unbekannte Methode/Attribut!")}}}))}function unQuote(str){return str.replace(/^"(.*)"$/,"$1")}function toggleLabels(){SVG.get("Haus_label").visible()?(SVG.get("Haus_label").hide(),SVG.get("Haus.Dach_label").hide(),SVG.get("Haus.Wand_label").hide(),SVG.get("Haus.Wand.Fenster_label").hide(),SVG.get("Haus.Wand.Tuer_label").hide()):(SVG.get("Haus_label").show(),SVG.get("Haus.Dach_label").show(),SVG.get("Haus.Wand_label").show(),SVG.get("Haus.Wand.Fenster_label").show(),SVG.get("Haus.Wand.Tuer_label").show())}